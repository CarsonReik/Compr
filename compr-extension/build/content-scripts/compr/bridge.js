(()=>{"use strict";const e=(...e)=>{console.info("[Compr Extension]",...e)},o=(...e)=>{console.error("[Compr Extension]",...e)};window.addEventListener("message",async s=>{if(s.origin!==window.location.origin)return;const n=s.data;if("CONNECT_EXTENSION"===n.type){const{userId:s,authToken:i}=n.payload;e("Received connection request from website",{userId:s});try{const o=await chrome.runtime.sendMessage({type:"CONNECT_BACKEND",payload:{userId:s,authToken:i}});window.postMessage({type:"EXTENSION_CONNECTED",payload:{success:o.success}},window.location.origin),e("Extension connected successfully")}catch(e){o("Failed to connect extension:",e),window.postMessage({type:"EXTENSION_CONNECTED",payload:{success:!1,error:e instanceof Error?e.message:"Unknown error"}},window.location.origin)}}if("VERIFY_SESSION"===n.type){const{platform:s}=n.payload;e("Received session verification request",{platform:s});try{const o=await chrome.runtime.sendMessage({type:"VERIFY_SESSION",payload:{platform:s}});window.postMessage({type:"SESSION_VERIFIED",payload:{success:o.success,error:o.error}},window.location.origin),e("Session verification completed",{success:o.success})}catch(e){o("Failed to verify session:",e),window.postMessage({type:"SESSION_VERIFIED",payload:{success:!1,error:e instanceof Error?e.message:"Unknown error"}},window.location.origin)}}}),window.postMessage({type:"EXTENSION_READY",payload:{}},window.location.origin),e("Compr bridge content script loaded")})();